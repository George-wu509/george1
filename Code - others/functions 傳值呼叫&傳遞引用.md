
傳值呼叫pass by value
傳遞引用 pass by reference

|                                                                 | 傳值value (不改變)                                                                                                                                                                    | 傳引用reference (改變)                                                                                                   |
| --------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------- |
| Matlab<br>([COW](https://imageslr.com/2020/copy-on-write.html)) | 數字 n=0、<br>布林值t=true/false<br>數組 A = [1, 2, 3; 4, 5, 6]、<br>struct S.name = 'Alice';S.age = 30、<br>Cell C = {1, 'text', [2, 3, 4]}、<br>Table T = table([1; 2], {'Alice'; 'Bob'}) |                                                                                                                     |
| python                                                          | 數字n=0、<br>字串s='abc'<br>布林值t=True/False<br>TupleT=(1, 2, 3)->T+=(4,5)                                                                                                             | 數組A=[1, 2, 3]->A[0]=5<br>字典D={"name": "Alice", "age": 25}<br>       ->D["age"]=1<br>集合S={1, 2, 3}->S.add(4)<br>自定義類 |
| C++                                                             | 傳值                                                                                                                                                                               | Reference、指針                                                                                                        |

在MATLAB中，當你執行 `addfun(A)` 時，MATLAB 傳遞的是 `A` 的值，而不是引用（即傳值呼叫）。因此，在 `addfun(A)` 函數內對 `A` 的更改不會影響到 `main` 函數中的變數 `A`。換句話說，`addfun(A)` 只是在函數內部對 `A` 做局部變更，當這個函數執行完畢後，`main` 函數中的 `A` 仍然保持不變。

在 Python 中，傳遞的也是物件的「引用」，但是否會改變原始變數取決於物件的可變性（mutable）。對於像整數這種不可變物件，即使你在函數內對它進行修改，原變數的值也不會改變。如果你要更新變數，則需要將函數的回傳值賦值給變數，就像 MATLAB 中一樣。

| MATLAB                                                                                                                                                       | PYTHON                                                                                                                                                                  |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| function main()<br>   A = 0;<br>   <mark style="background: #FFB86CA6;">A = addfun(A)</mark>; <br>   disp(A);<br><br>function A = addfun(A)<br>   A = A + 2; | def main():<br>    A = 0<br>    <mark style="background: #FFB86CA6;">A = addfun(A)</mark>  # 更新A<br>    print(A)<br><br>def addfun(A):<br>    A = A + 2<br>    return A |

### C++ 的情況

在 C++ 中，函數默認也是<mark style="background: #FFB86CA6;">傳值呼叫</mark>，也就是說，傳遞的只是變數的一個副本，函數內的改變不會影響原變數。如果你希望函數改變傳入的變數，你需要使用<mark style="background: #FFB86CA6;">「引用傳遞」（pass by reference）或指針</mark>。

| C++                                                                                                                                                                                                                                              | C++                                                                                                                                                                                                                                                       |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 傳值呼叫，變數不會改變                                                                                                                                                                                                                                      | 傳遞引用                                                                                                                                                                                                                                                      |
| void <mark style="background: #BBFABBA6;">addfun(int A)</mark> {<br>    A = A + 2;<br>}<br><br>int main() {<br>    int A = 0;<br>    <mark style="background: #FFB86CA6;">addfun(A)</mark>;  // A 不會被更新<br>    std::cout << A << std::endl;<br>} | void <mark style="background: #BBFABBA6;">addfun(int &A)</mark> {  // 傳遞引用<br>    A = A + 2;<br>}<br><br>int main() {<br>    int A = 0;<br>    <mark style="background: #FFB86CA6;">addfun(A)</mark>;  // A 會被更新<br>    std::cout << A << std::endl;<br>} |
總結來說，在 MATLAB、Python 和 C++ 中，傳遞變數給函數時的行為取決於語言的特性：

1. **MATLAB**：傳值呼叫，需回傳賦值才能更新變數。
2. **Python**：對於不可變物件需回傳賦值才能更新變數，對於可變物件（如列表、字典）可以在函數內直接修改。
3. **C++**：傳值呼叫，需使用引用或指針來更新原變數的值。
4. 


### MATLAB中的引用傳遞

在MATLAB中，基本類型（如<mark style="background: #FFB86CA6;">數字、布林值</mark>等）都是「傳值」傳遞，也就是傳遞變數的副本，而不會影響原來的變數。然而，MATLAB中的<mark style="background: #FFB86CA6;">數組、結構體、對象</mark>等複雜類型是以「句柄」方式傳遞的，可以類似於「引用傳遞」。具體來說，對於這些可變數據結構（如結構體或數組），如果你在函數中對其進行修改，原變數的值也會被更新。

但是，如果要實現對標量變數的真正引用傳遞，你需要將該變數包裝成結構體或對象。這樣可以在函數中修改其值，且變化會反映到主函數中。這樣當執行 `main()` 時，`S.A` 會變成 2。

| MATLAB                        |                                                                                                                                                                                                                                                                |
| ----------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 傳引用:(數組、結構體、對象)<br>?????????? | function main()<br>    A = [1, 2, 3];  % 數組可以視為引用傳遞<br>    <mark style="background: #FFB86CA6;">modifyArray(A)</mark>;<br>    disp(A);<br><br>function <mark style="background: #BBFABBA6;">modifyArray(A)</mark><br>    A(1) = 10;  % 修改數組的值，main中的A也會被修改     |
| 傳值:(數字、布林值)                   | function main()<br>   A = 0;<br>   <mark style="background: #FFB86CA6;">A = addfun(A)</mark>; <br>   disp(A);<br><br>function A = addfun(A)<br>   A = A + 2;                                                                                                   |
| 傳引用:(數組、結構體、對象)<br>?????????? | function main()<br>    S.A = 0;  % 將變數A包裝在結構體中<br>    <mark style="background: #FFB86CA6;">modifyStruct(S)</mark>;<br>    disp(S.A);<br><br>function <mark style="background: #BBFABBA6;">modifyStruct(S)</mark><br>    S.A = S.A + 2;  % 修改結構體內的A，主函數中的A也會被修改 |

### Python中的引用傳遞

在Python中，所有的變數都是物件，當你將變數傳遞給函數時，實際上傳遞的是物件的引用。但是，對於不可變對象（如整數、字符串、元組等），即使傳遞的是引用，由於不可變的特性，無法直接修改其值。而對於可變對象（如列表、字典等），在函數內修改會直接影響外部的變數。在這個例子中，整數 `A` 是不可變對象，雖然傳遞的是引用，但 `modify_value()` 函數內部的修改並不會影響 `main` 函數中的 `A`。

可變對象的例子（列表）在這裡，列表 `L` 是可變對象，因此在函數內部對它的修改會反映在主函數中。

引用傳遞的模擬方法（包裝對象）：如果想要實現對不可變對象的引用傳遞效果，你可以將其包裝在一個可變的容器中，例如列表或自定義類。在這個例子中，`Container` 類模擬了引用傳遞的效果，`modify_container()` 修改了容器中的 `value`，並且這個變化反映在外部變數 `A` 中。

### 傳值呼叫（pass by value）與傳遞引用（pass by reference）總結

在Python中，實際上並沒有嚴格意義上的傳值呼叫或傳遞引用。Python是基於對象模型的，當變數傳遞到函數時，實際上傳遞的是對象的引用。具體行為取決於對象是否可變：

- **不可變對象**（如整數、字符串、元組）：傳入函數後的修改不會影響原對象，因為不可變對象的任何修改都會創建一個新對象。
- **可變對象**（如列表、字典、集合）：傳入函數後的修改會影響原對象，因為可變對象是通過引用傳遞的。

這使得Python的傳參行為介於「傳值」和「傳引用」之間，但更接近於「傳引用」的概念，特別是對於可變對象來說。

#### 不可變對象的例子（整數）：


|                     |                                                                                                                                                                                                                                                                                                               |
| ------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 不可變對象的例子（整數）        | def modify_value(A):<br>    A += 2  # 嘗試修改值，但不會影響外部變數<br><br>def main():<br>    A = 0<br>    <mark style="background: #FFB86CA6;">modify_value(A)</mark><br>    print(A)  # A 仍然是 0<br><br>main()                                                                                                             |
| 可變對象的例子（列表）         | def modify_list(L):<br>    L[0] = 10  # 修改列表的第一個元素，會影響外部變數<br><br>def main():<br>    L = [1, 2, 3]<br>    <mark style="background: #FFB86CA6;">modify_list(L)</mark><br>    print(L)  # L 變成 [10, 2, 3]<br><br>main()                                                                                         |
| 引用傳遞的模擬方法<br>（包裝對象） | class Container:<br>    def __init__(self, value):<br>        self.value = value<br><br>def modify_container(container):<br>    container.value += 2  # 修改容器內的值，會影響外部變數<br><br>def main():<br>    A = Container(0)  # 將A包裝在容器內<br>    modify_container(A)<br>    print(A.value)  # A.value 變成 2<br><br>main() |
### 總結

- **MATLAB** 中，標量變數默認是傳值，需要將其包裝成結構體或對象來實現引用傳遞效果；對於數組、結構體等可變類型，傳遞的是「引用」，因此在函數內部的修改會影響原變數。
- **Python** 中，對於不可變對象（如整數、字符串），即使傳遞的是引用，修改不會影響外部變數；對於可變對象（如列表、字典），傳遞的是引用，因此在函數內部的修改會影響外部變數。如果需要對不可變對象實現類似引用傳遞的效果，可以將它們包裝在可變容器中。

這樣通過包裝對象，MATLAB 和 Python 都能模擬引用傳遞的效果。


