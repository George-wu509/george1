
### Harris 角点检测算法概述

Harris 角点检测是一种经典的特征检测算法，用于在图像中找到角点（corners）。角点是指图像中亮度变化较大的区域，通常可以提供重要的几何信息。该算法基于梯度信息，利用局部窗口内图像的灰度变化来判断是否存在角点。

#### 一、Harris 角点检测的原理

1. **局部灰度变化**：Harris 角点检测的核心思想是：当你在某个点附近的小区域内移动窗口时，如果该窗口的灰度变化较大，那么这个点可能是角点。具体来说，在一个角点处，无论窗口朝哪个方向移动，图像灰度都会有显著变化。
    
2. **梯度计算**：首先，对图像进行梯度计算，计算每个像素在水平方向（x 方向）和垂直方向（y方向）的变化率，得到梯度图像。具体的梯度可以通过 Sobel 滤波器或 Roberts 滤波器来计算。
    
    梯度表示为：
    
    $\Huge Ix(x,y)=\frac{∂I}{∂x},Iy(x,y)=\frac{∂I}{∂y}$
    
    其中，$I_x$ 和 $I_y$​ 分别是水平方向和垂直方向的梯度。
    
3. **结构张量（Harris 矩阵）**：根据图像的局部梯度信息，构造一个 2x2 的结构张量（Harris 矩阵），其形式为：
    
    $\huge M = \begin{pmatrix} \sum I_x^2 & \sum I_x I_y \\ \sum I_x I_y & \sum I_y^2 \end{pmatrix}$
    
    其中，$\sum$ 表示在窗口内的求和操作，$I_x^2$​、$I_y^2$​ 和 $I_x I_y$​ 分别表示在窗口内的梯度的平方和乘积。
    
4. **角点响应函数（Harris 响应公式）**：为了判断某个点是否是角点，我们需要分析矩阵 MMM 的特征值。这些特征值可以解释窗口内灰度变化的程度。Harris 使用以下公式来计算角点响应值 RRR：
    
	$R = \text{det}(M) - k \cdot (\text{trace}(M))^2$

-  $\text{det}(M) = \lambda_1 \cdot \lambda_2$​ 是矩阵 M 的行列式，表示两个特征值的乘积；
-  $\text{trace}(M) = \lambda_1 + \lambda_2​$ 是矩阵 M 的迹，表示两个特征值的和；
- k是一个经验常数，一般取值为 0.04 到 0.06 之间。

1. **角点判别**：
    
    - 当 R>0R > 0R>0 时，该点是角点。
    - 当 R≈0R \approx 0R≈0 时，该点位于边缘。
    - 当 R<0R < 0R<0 时，该点位于平坦区域。

#### 二、Harris 角点检测的步骤

1. **计算图像的梯度**：使用 Sobel 滤波器或类似方法，计算图像的水平方向和垂直方向的梯度 IxI_xIx​ 和 IyI_yIy​。
    
2. **构建结构张量 M**：在每个像素点上，通过计算其邻域内的梯度平方和乘积，得到结构张量 MMM。
    
3. **计算角点响应函数 R**：根据 Harris 响应公式 $R = \text{det}(M) - k \cdot (\text{trace}(M))^2$，计算每个像素的角点响应值。
    
4. **阈值化**：将角点响应值与设定的阈值进行比较，选出角点响应值较大的点作为角点。
    
5. **非极大值抑制**：为了去除噪声和非显著角点，使用非极大值抑制技术，保留局部最大值作为最终的角点。
    

#### 三、Harris 角点检测的应用

1. **图像配准**：Harris 角点检测经常用于图像配准中，尤其是在不同视角或不同尺度的图像之间进行对齐时。角点可以作为稳健的特征点来匹配不同的图像。
    
2. **运动跟踪**：在视频序列中，角点是常用的跟踪特征点。Harris 角点检测可以检测到视频帧中的关键点，然后通过光流或其他跟踪算法进行特征点跟踪。
    
3. **物体识别与匹配**：角点特征常用于物体识别任务中。在多视角或局部遮挡的情况下，角点作为局部特征可以帮助识别出目标物体。
    
4. **立体视觉**：在立体视觉任务中，角点可以作为特征匹配的基础。通过匹配左右视图中的角点，可以得到场景的深度信息。
    
5. **图像拼接**：Harris 角点检测在图像拼接（如全景图生成）中具有重要作用，检测到的角点可以用于图像间的特征匹配，进而实现拼接。
    

总的来说，Harris 角点检测是一种基于梯度的鲁棒特征检测算法，应用广泛，尤其适合在图像配准、运动跟踪、物体识别等任务中使用。


Ref:  https://medium.com/@itberrios6/harris-corner-and-edge-detector-4169312aa2f8