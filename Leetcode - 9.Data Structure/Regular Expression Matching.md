Lintcode 154
å®ç°æ”¯æŒÂ `'.'`Â å’ŒÂ `'*'`Â çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ã€‚`'.'`Â åŒ¹é…ä»»æ„ä¸€ä¸ªå­—æ¯ã€‚`'*'`Â åŒ¹é…é›¶ä¸ªæˆ–è€…å¤šä¸ªå‰é¢çš„å…ƒç´ ï¼Œ`'*'`Â å‰ä¿è¯æ˜¯ä¸€ä¸ªéÂ `'*'`Â å…ƒç´ ã€‚åŒ¹é…åº”è¯¥è¦†ç›–æ•´ä¸ªè¾“å…¥å­—ç¬¦ä¸²ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸€éƒ¨åˆ†ã€‚éœ€è¦å®ç°çš„å‡½æ•°æ˜¯ï¼š  
bool isMatch(string s, string p)

**æ ·ä¾‹ 1:**
```python
"""
è¾“å…¥ï¼š"aa"ï¼Œ"a"
è¾“å‡ºï¼šfalse
è§£é‡Šï¼š
æ— æ³•åŒ¹é…
```
**æ ·ä¾‹ 2:**
```python
"""
è¾“å…¥ï¼š"aa"ï¼Œ"a*"
è¾“å‡ºï¼štrue
è§£é‡Šï¼š
'*' å¯ä»¥é‡å¤ a
```
**æ ·ä¾‹ 3:**
```python
"""
è¾“å…¥ï¼š"aab", "c*a*b"
è¾“å‡ºï¼štrue
è§£é‡Šï¼š
"c*" ä½œä¸ºä¸€ä¸ªæ•´ä½“åŒ¹é… 0 ä¸ª 'c' ä¹Ÿå°±æ˜¯ ""
"a*" ä½œä¸ºä¸€ä¸ªæ•´ä½“åŒ¹é… 2 ä¸ª 'a' ä¹Ÿå°±æ˜¯ "aa"
"b" åŒ¹é… "b"
æ‰€ä»¥ "c*a*b" å¯ä»¥åŒ¹é… "aab"
```
**æ ·ä¾‹4ï¼š**
```python
"""
è¾“å…¥ï¼š"abcc", ".*"
è¾“å‡ºï¼štrue
è§£é‡Šï¼š
".*" ä½œä¸ºä¸€ä¸ªæ•´ä½“åŒ¹é… 4 ä¸ª '.' ä¹Ÿå°±æ˜¯ "...."
ç¬¬ä¸€ä¸ª "." åŒ¹é…ç¬¬ä¸€ä¸ªå­—ç¬¦ "a"
ç¬¬äºŒä¸ª "." åŒ¹é…ç¬¬äºŒä¸ªå­—ç¬¦ "b"
æœ€åä¸¤ä¸ª "." åŒ¹é…å­—ç¬¦ "cc"
```


```python
class Solution:
    """
    @param s: A string 
    @param p: A string includes "?" and "*"
    @return: is Match?
    """
    def is_match(self, s, p):
        return self.is_match_helper(s, 0, p, 0, {})
        
        
    # s ä» i å¼€å§‹çš„åç¼€èƒ½å¦åŒ¹é…ä¸Š p ä» j å¼€å§‹çš„åç¼€
    # èƒ½ return True
    def is_match_helper(self, s, i, p, j, memo):
        if (i, j) in memo:
            return memo[(i, j)]
        
        # s is empty
        if len(s) == i:
            return self.is_empty(p[j:])
            
        if len(p) == j:
            return False
            
        if j + 1 < len(p) and p[j + 1] == '*':
            matched = self.is_match_char(s[i], p[j]) and self.is_match_helper(s, i + 1, p, j, memo) or \
                self.is_match_helper(s, i, p, j + 2, memo)
        else:                
            matched = self.is_match_char(s[i], p[j]) and self.is_match_helper(s, i + 1, p, j + 1, memo)
        
        memo[(i, j)] = matched
        return matched
        
        
    def is_match_char(self, s, p):
        return s == p or p == '.'
        
    def is_empty(self, p):
        if len(p) % 2 == 1:
            return False
        
        for i in range(len(p) // 2):
            if p[i * 2 + 1] != '*':
                return False
        return True
```
pass


# **LintCode 154: Regular Expression Matching è§£æ³•åˆ†æ**

## **è§£é¡Œç›®æ¨™**

çµ¦å®šä¸€å€‹å­—ä¸² `s` å’Œä¸€å€‹æ¨¡å¼ `p`ï¼Œå…¶ä¸­ `p` å¯èƒ½åŒ…å«ï¼š

- `.`ï¼šåŒ¹é…ä»»æ„ä¸€å€‹å­—å…ƒã€‚
- `*`ï¼šè¡¨ç¤º `*` å‰é¢çš„å­—ç¬¦å¯ä»¥å‡ºç¾ **0 æ¬¡æˆ–å¤šæ¬¡**ã€‚

åˆ¤æ–· `s` æ˜¯å¦èƒ½è¢« `p` å®Œå…¨åŒ¹é…ã€‚

---

## **è§£æ³•æ ¸å¿ƒ**

é€™é¡Œæ˜¯ç¶“å…¸çš„ **æ­£å‰‡è¡¨é”å¼åŒ¹é… (Regex Matching)** å•é¡Œï¼Œæ ¸å¿ƒæ˜¯ï¼š

1. **éè¿´ (Recursion) + è¨˜æ†¶åŒ– (Memoization)**
2. **å‹•æ…‹è¦åŠƒ (Dynamic Programming)**

### **ç‚ºä»€éº¼è¦ç”¨éè¿´ï¼Ÿ**

- **è¦å‰‡éå¸¸è¤‡é›œ**ï¼Œä½†å¯ä»¥æ‹†è§£æˆ **å­å•é¡Œ (subproblems)**ï¼Œå³ï¼š
    
    - `p[j] == s[i]` æˆ– `p[j] == '.'` â†’ ç¹¼çºŒåŒ¹é… `s[i+1]` å’Œ `p[j+1]`
    - `p[j] == '*'` â†’ å¯èƒ½é¸æ“‡ `0` æ¬¡ (`è·³é p[j-1]`) æˆ– `å¤šæ¬¡` (`ç¹¼çºŒåŒ¹é… s[i]`)
- **é‡è¤‡å­å•é¡Œ**ï¼šç›¸åŒ `s[i:]` å’Œ `p[j:]` å¯èƒ½è¢«å¤šæ¬¡è¨ˆç®—ï¼Œæ‰€ä»¥ç”¨ **è¨˜æ†¶åŒ– (Memoization)** ä¾†é¿å… **æŒ‡æ•¸æ™‚é–“è¤‡é›œåº¦**ã€‚
    

---

## **è§£æ³•æ­¥é©Ÿ**

### **Step 1: å»ºç«‹éè¿´å‡½æ•¸ `is_match_helper(s, i, p, j, memo)`**

- **ç›®æ¨™**ï¼šåˆ¤æ–· `s[i:]` æ˜¯å¦èƒ½åŒ¹é… `p[j:]`ã€‚
- **å‚™å¿˜éŒ„ `memo`**ï¼šè¨˜éŒ„ `(i, j)` çš„åŒ¹é…çµæœï¼Œé¿å…é‡è¤‡è¨ˆç®—ã€‚

---

### **Step 2: åŸºæœ¬æƒ…æ³ (Base Cases)**

1. **å­—ä¸² `s` å·²ç¶“åŒ¹é…å®Œ (`i == len(s)`)**
    
    - é€™æ™‚å€™ `p[j:]` å¯èƒ½é‚„æœ‰å‰©ä¸‹çš„ `*` æ¨¡å¼ï¼Œæ¯”å¦‚ `"a*"`ï¼Œæ‰€ä»¥è¦æª¢æŸ¥ï¼š

        `if len(s) == i:     return self.is_empty(p[j:])`
        
    - **`is_empty(p[j:])` æ–¹æ³•**
        - ç¢ºä¿ `p[j:]` çš„æ¯å€‹å­—ç¬¦å¾Œé¢éƒ½è·Ÿè‘— `*`ï¼Œå¦å‰‡ `s` ç„¡æ³•åŒ¹é… `p`ã€‚
2. **æ¨¡å¼ `p` å·²ç¶“åŒ¹é…å®Œ (`j == len(p)`)**
    
    - è‹¥ `s` ä»æœ‰æœªåŒ¹é…çš„å­—ç¬¦ï¼Œå‰‡è¿”å› `False`ã€‚

---

### **Step 3: éè¿´è™•ç† `p[j]`**

1. **`p[j + 1] == '*'` (æ˜Ÿè™ŸåŒ¹é…)**
    
    - `'*'` å¯ä»¥è®“ `p[j]` **åŒ¹é… 0 æ¬¡æˆ–å¤šæ¬¡**ï¼š
        
        python
        
        è¤‡è£½ç·¨è¼¯
        
        `if j + 1 < len(p) and p[j + 1] == '*':     matched = (self.is_match_char(s[i], p[j]) and self.is_match_helper(s, i + 1, p, j, memo)) or \               self.is_match_helper(s, i, p, j + 2, memo)`
        
    - **å…©ç¨®é¸æ“‡**ï¼š
        - **ä½¿ç”¨ `p[j]` (`s[i]` å’Œ `p[j]` åŒ¹é…æˆåŠŸï¼Œå‰‡ç¹¼çºŒ `s[i+1]` å° `p[j]`)**ã€‚
        - **ä¸ä½¿ç”¨ `p[j]` (`è·³é` `p[j:j+2]`ï¼Œå› ç‚º `*` å¯ä»¥è®“ `p[j]` å‡ºç¾ 0 æ¬¡)**ã€‚
2. **`p[j] != '*'` (æ­£å¸¸åŒ¹é…)**
    
    - å¦‚æœ `p[j]` ä¸æ˜¯ `'*'`ï¼Œå‰‡ç›´æ¥åŒ¹é…ç•¶å‰å­—ç¬¦ï¼š
        
        python
        
        è¤‡è£½ç·¨è¼¯
        
        `matched = self.is_match_char(s[i], p[j]) and self.is_match_helper(s, i + 1, p, j + 1, memo)`
        
    - **`is_match_char(s, p)` æ–¹æ³•**
        
        python
        
        è¤‡è£½ç·¨è¼¯
        
        `def is_match_char(self, s, p):     return s == p or p == '.'`
        
    - **å…©ç¨®å¯èƒ½åŒ¹é…æˆåŠŸçš„æƒ…æ³**ï¼š
        - `s[i] == p[j]`ï¼ˆå­—ç¬¦å®Œå…¨åŒ¹é…ï¼‰
        - `p[j] == '.'`ï¼ˆå¯ä»¥åŒ¹é…ä»»ä½•å­—ç¬¦ï¼‰

---

### **Step 4: è¨˜æ†¶åŒ–éè¿´**

- **ç‚ºäº†é¿å…é‡è¤‡è¨ˆç®— `(i, j)`ï¼Œæˆ‘å€‘å°‡çµæœå­˜å…¥ `memo`**
- è‹¥å·²ç¶“è¨ˆç®—é `(i, j)`ï¼Œç›´æ¥è¿”å›ï¼š

    `if (i, j) in memo:     return memo[(i, j)]`
    

---

## **è®Šæ•¸å®šç¾©**

|è®Šæ•¸åç¨±|ä½œç”¨|
|---|---|
|`s`|ç›®æ¨™å­—ä¸²|
|`p`|æ­£å‰‡è¡¨é”å¼æ¨¡å¼|
|`i`|`s` çš„ç•¶å‰ç´¢å¼•|
|`j`|`p` çš„ç•¶å‰ç´¢å¼•|
|`memo`|è¨˜éŒ„ `(i, j)` çš„åŒ¹é…çµæœï¼Œé¿å…é‡è¤‡è¨ˆç®—|
|`matched`|ç•¶å‰åŒ¹é…çµæœ|
|`is_match_char(s[i], p[j])`|åˆ¤æ–· `s[i]` æ˜¯å¦åŒ¹é… `p[j]`|
|`is_empty(p[j:])`|åˆ¤æ–· `p[j:]` æ˜¯å¦ç‚ºç©ºï¼ˆåªåŒ…å« `a*`ã€`b*` é¡å‹ï¼‰|

---

## **å…·é«”ç¯„ä¾‹**

### **ç¯„ä¾‹ 1**

`è¼¸å…¥: s = "aa", p = "a*"`

**åŒ¹é…éç¨‹**

1. `p[1] == '*'`ï¼š
    - `'*'` ä»£è¡¨ `p[0] = 'a'` **å¯ä»¥åŒ¹é… 0 æ¬¡æˆ–å¤šæ¬¡**ã€‚
    - **é¸æ“‡åŒ¹é… 0 æ¬¡** â†’ `s = "aa", p = ""`ï¼ˆåŒ¹é… `p[j+2:]`ï¼‰
    - **é¸æ“‡åŒ¹é… 1 æ¬¡** â†’ `s = "a", p = "a*"`
    - **é¸æ“‡åŒ¹é… 2 æ¬¡** â†’ `s = "", p = "a*"`

**çµæœ**

`True`

---

### **ç¯„ä¾‹ 2**

`è¼¸å…¥: s = "mississippi", p = "mis*is*p*."`

**åŒ¹é…éç¨‹**

- `"mis*"` â†’ `"m"` `"i"` `"s*"` (`s*` å¯åŒ¹é… `s` 0 æˆ–å¤šæ¬¡)
- `"is*p*"` â†’ `"i"` `"s*"` `"p*"`
- `.` å¯åŒ¹é… `i`
- æœ€çµ‚åŒ¹é…æˆåŠŸ

**çµæœ**

`True`

---

## **æ™‚é–“èˆ‡ç©ºé–“è¤‡é›œåº¦åˆ†æ**

### **æ™‚é–“è¤‡é›œåº¦**

- **æœ€å·®æƒ…æ³**ï¼šæ¯å€‹ `(i, j)` éƒ½å¯èƒ½è¢«è¨ˆç®—ä¸€æ¬¡ã€‚
- **é€é `memo` å„ªåŒ–å¾Œ**ï¼Œç¸½å…±æœ‰ `O(m * n)` å€‹å¯èƒ½çš„ `(i, j)` ç‹€æ…‹ï¼ˆ`m` ç‚º `s` é•·åº¦ï¼Œ`n` ç‚º `p` é•·åº¦ï¼‰ã€‚
- **æ™‚é–“è¤‡é›œåº¦ï¼š`O(m * n)`**ã€‚

### **ç©ºé–“è¤‡é›œåº¦**

- **éè¿´æ·±åº¦** æœ€å¤š `O(m + n)`ã€‚
- **å‚™å¿˜éŒ„ (`memo`)** éœ€è¦ `O(m * n)` ç©ºé–“ã€‚
- **ç¸½è¨ˆï¼š`O(m * n)`**ã€‚

---

## **å…¶ä»–è§£æ³• (ä¸å¯« Code)**

1. **å‹•æ…‹è¦åŠƒ `O(m * n)`**
    
    - `dp[i][j]` è¡¨ç¤º `s[:i]` æ˜¯å¦èƒ½åŒ¹é… `p[:j]`ã€‚
    - ä½¿ç”¨ `dp` é™£åˆ—å­˜å„²æ‰€æœ‰å¯èƒ½ç‹€æ…‹ï¼Œé¿å…éè¿´ã€‚
2. **æš´åŠ›éè¿´ `O(2^m)`**
    
    - ç›´æ¥å˜—è©¦æ‰€æœ‰å¯èƒ½çš„ `*` åŒ¹é…æ–¹å¼ï¼Œæ™‚é–“è¤‡é›œåº¦ **æŒ‡æ•¸ç´šåˆ¥**ï¼Œä¸å¯è¡Œã€‚

---

## **ç¸½çµ**

|**è§£æ³•**|**æ™‚é–“è¤‡é›œåº¦**|**é©ç”¨å ´æ™¯**|**å„ªç¼ºé»**|
|---|---|---|---|
|**éè¿´ + è¨˜æ†¶åŒ– (`O(m * n)`)**|`O(m * n)`|æœ€é©åˆä¸€èˆ¬æƒ…å¢ƒ|âœ… é«˜æ•ˆï¼Œå¯è™•ç†å¤§ `m, n`|
|**å‹•æ…‹è¦åŠƒ (`O(m * n)`)**|`O(m * n)`|é©åˆå¤§é‡æ¨¡å¼åŒ¹é…|âœ… è¨˜æ†¶åŒ–å„ªåŒ–ï¼Œç„¡éè¿´|
|**æš´åŠ›éè¿´ (`O(2^m)`)**|`O(2^m)`|é©ç”¨æ–¼å°æ•¸æ“š|âŒ å¤ªæ…¢ï¼Œä¸é©ç”¨|

âœ… **æœ€ä½³é¸æ“‡ï¼šéè¿´ + è¨˜æ†¶åŒ– (`O(m * n)`)**ï¼Œæ™‚é–“ `O(m * n)`ï¼Œç©ºé–“ `O(m * n)`ï¼Œé©åˆæ‰€æœ‰å ´æ™¯ ğŸš€

  

O