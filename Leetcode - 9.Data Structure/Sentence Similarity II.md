Lintcode 855
ç»™å‡ºä¸¤ä¸ªå¥å­â€œwords1â€ã€â€œwords2â€(æ¯ä¸ªå•è¯éƒ½è¡¨ç¤ºä¸ºå­—ç¬¦ä¸²æ•°ç»„) å’Œä¸€ç»„ç›¸ä¼¼çš„å•è¯å¯¹â€œpairâ€ï¼Œåˆ¤æ–­ä¸¤ä¸ªå¥å­æ˜¯å¦ç›¸ä¼¼ã€‚  
ä¾‹å¦‚ï¼Œ' words1 = ["great"ï¼Œ "acting"ï¼Œ" skills"]å’Œ' words2 = ["fine"ï¼Œ "drama"ï¼Œ "talent"]æ˜¯ç›¸ä¼¼çš„ï¼Œå¦‚æœç›¸ä¼¼çš„å•è¯å¯¹æ˜¯' pair = [[great"ï¼Œ "good"]ï¼Œ ["fine"ï¼Œ "good"]ï¼Œ ["acting"ï¼Œ"drama"]ï¼Œ ["skills"ï¼Œ"talent"]]ã€‚  
æ³¨æ„ï¼Œç›¸ä¼¼æ€§å…³ç³»æ˜¯å¯ä¼ é€’çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœâ€œgreatâ€å’Œâ€œgoodâ€ç›¸ä¼¼ï¼Œâ€œfineâ€å’Œâ€œgoodâ€ç›¸ä¼¼ï¼Œé‚£ä¹ˆâ€œgreatâ€å’Œâ€œfineâ€**ç›¸ä¼¼ã€‚**  
ç›¸ä¼¼æ€§ä¹Ÿæ˜¯å¯¹ç§°çš„ã€‚ä¾‹å¦‚ï¼Œâ€œgreatâ€å’Œâ€œfineâ€ç›¸ä¼¼ç­‰åŒäºâ€œfineâ€å’Œâ€œgreatâ€ç›¸ä¼¼ã€‚  
è€Œä¸”ï¼Œä¸€ä¸ªå•è¯æ€»æ˜¯å’Œå®ƒè‡ªå·±ç›¸ä¼¼ã€‚ä¾‹å¦‚ï¼Œ' words1 = ["great"] 'ã€' words2 = ["great"] 'ã€' pair =[] 'è¿™å‡ ä¸ªå¥å­æ˜¯ç›¸ä¼¼çš„ï¼Œå³ä½¿æ²¡æœ‰æŒ‡å®šç›¸ä¼¼çš„å•è¯å¯¹ã€‚  
æœ€åï¼Œå¥å­åªæœ‰åœ¨å•è¯æ•°é‡ç›¸åŒçš„æƒ…å†µä¸‹æ‰èƒ½ç›¸ä¼¼ã€‚æ‰€ä»¥åƒwords1 = ["great"]è¿™æ ·çš„å¥å­æ°¸è¿œä¸å¯èƒ½å’Œwords2 = ["doubleplus"ï¼Œ"good"]ç›¸ä¼¼ã€‚


**æ ·ä¾‹ 1:**
```python
"""
è¾“å…¥:
["7", "5", "4", "11", "13", "15", "19", "12", "0", "10"]
["16", "1", "7", "3", "15", "10", "13", "2", "19", "8"]
[["6", "18"], ["8", "17"], ["1", "13"], ["0", "8"], ["9", "14"], ["11", "17"], ["11", "19"], ["13", "16"], ["0", "18"], ["3", "11"], ["1", "9"], ["2", "11"], ["2", "4"], ["0", "19"], ["8", "12"], ["8", "19"], ["16", "19"], ["1", "11"], ["2", "18"], ["0", "16"], ["7", "11"], ["6", "8"], ["9", "17"], ["8", "16"], ["3", "13"], ["7", "9"], ["7", "10"], ["3", "6"], ["15", "19"], ["1", "5"], ["2", "14"], ["1", "18"], ["8", "15"], ["14", "19"], ["3", "17"], ["6", "10"], ["5", "17"], ["10", "15"], ["1", "10"], ["4", "6"]]
è¾“å‡º:
true
```
**æ ·ä¾‹ 2:**
```python
"""
è¾“å…¥:
["great","acting","skills"]
["fine","drama","talent"]
[["great","good"],["fine","good"],["drama","acting"],["skills","talent"]]
è¾“å‡º:
true
```



```python
"""
class Solution:
    def are_sentences_similar_two(self, words1: List[str], words2: List[str], pairs: List[List[str]]) -> bool:
        if len(words1) != len(words2): return False
        import itertools
        index = {}
        count = itertools.count()
        dsu = DSU(2 * len(pairs))
        for pair in pairs:
            for p in pair:
                if p not in index:
                    index[p] = next(count)
            dsu.union(index[pair[0]], index[pair[1]])

        return all(w1 == w2 or
                   w1 in index and w2 in index and
                   dsu.find(index[w1]) == dsu.find(index[w2])
                   for w1, w2 in zip(words1, words2))
class DSU:
    def __init__(self, N):
        self.par = list(range(N))
    def find(self, x):
        if self.par[x] != x:
            self.par[x] = self.find(self.par[x])
        return self.par[x]
    def union(self, x, y):
        self.par[self.find(x)] = self.find(y)
```
pass

# **LintCode 855: Sentence Similarity II è§£æ³•è©³ç´°è§£æ**

## **å•é¡Œæè¿°**

çµ¦å®šå…©å€‹å¥å­ `words1` å’Œ `words2`ï¼Œå®ƒå€‘çš„é•·åº¦ç›¸åŒã€‚æˆ‘å€‘é‚„æœ‰ä¸€çµ„**ç›¸ä¼¼å–®è©å° `pairs`**ï¼Œå…¶ä¸­æ¯å€‹ `pairs[i] = [a, b]` è¡¨ç¤º `a` å’Œ `b` æ˜¯**ç›¸ä¼¼çš„å–®è©**ã€‚

æˆ‘å€‘è¦åˆ¤æ–· `words1` å’Œ `words2` æ˜¯å¦å¯ä»¥è¦–ç‚º**ç›¸ä¼¼çš„å¥å­**ï¼š

- `words1[i]` å’Œ `words2[i]` **è¦éº¼ç›¸åŒï¼Œè¦éº¼åœ¨ç›¸ä¼¼å–®è©å°ä¸­å¯ä»¥é€£é€š**ã€‚

---

## **è§£æ³•åˆ†æ**

é€™é¡Œçš„æ ¸å¿ƒåœ¨æ–¼ï¼š

1. **å¦‚ä½•åˆ¤æ–·å–®è© `w1` å’Œ `w2` æ˜¯å¦ç›¸ä¼¼ï¼Ÿ**
    
    - ç›´æ¥æŸ¥æ‰¾ `pairs` æ•ˆç‡å¤ªä½ï¼Œå› æ­¤æˆ‘å€‘è¦**å»ºç«‹å–®è©ä¹‹é–“çš„é€£æ¥é—œä¿‚**ã€‚
    - **å¦‚æœ `w1` å’Œ `w2` é€šéè‹¥å¹²æ­¥ç›¸ä¼¼é—œä¿‚é€£æ¥ï¼Œé‚£éº¼å®ƒå€‘ä»ç„¶è¦–ç‚ºç›¸ä¼¼å–®è©**ã€‚
2. **å¦‚ä½•é«˜æ•ˆåœ°æŸ¥æ‰¾å–®è©ä¹‹é–“çš„é—œè¯ï¼Ÿ**
    
    - **ä½¿ç”¨ä¸¦æŸ¥é›†ï¼ˆUnion-Find / DSU, Disjoint Set Unionï¼‰ä¾†æ§‹å»ºé€£é€šåˆ†é‡**ã€‚
    - é€™æ¨£**å¯ä»¥å¿«é€ŸæŸ¥æ‰¾ `w1` å’Œ `w2` æ˜¯å¦å±¬æ–¼åŒä¸€çµ„**ã€‚
3. **ç‚ºä»€éº¼ä½¿ç”¨ä¸¦æŸ¥é›†ï¼ˆDSUï¼‰ï¼Ÿ**
    
    - **ä¸¦æŸ¥é›†èƒ½å¤ é«˜æ•ˆåˆä½µé—œè¯å–®è©**ã€‚
    - **åˆä½µèˆ‡æŸ¥æ‰¾çš„å‡æ”¤æ™‚é–“è¤‡é›œåº¦ç‚º `O(Î±(n)) â‰ˆ O(1)`**ï¼ˆé˜¿å…‹æ›¼å‡½æ•¸çš„åå‡½æ•¸ï¼‰ã€‚
    - **æ¯” BFS æˆ– DFS æ›´å¿«**ï¼Œå› ç‚ºæˆ‘å€‘ä¸éœ€è¦éæ­·æ•´å€‹åœ–ã€‚

---

## **è§£æ³•æ­¥é©Ÿ**

### **Step 1: æª¢æŸ¥ `words1` å’Œ `words2` é•·åº¦**

`if len(words1) != len(words2): return False`

- å¦‚æœé•·åº¦ä¸åŒï¼Œå‰‡**å¿…ç„¶ç„¡æ³•ç›¸ä¼¼**ï¼Œç›´æ¥è¿”å› `False`ã€‚

---

### **Step 2: ä½¿ç”¨ä¸¦æŸ¥é›†å»ºç«‹å–®è©ä¹‹é–“çš„é—œè¯**

`import itertools index = {}  # å–®è©æ˜ å°„åˆ°å”¯ä¸€çš„æ•¸å­—ç´¢å¼• count = itertools.count()  # è‡ªå‹•ç”Ÿæˆå”¯ä¸€ç´¢å¼• dsu = DSU(2 * len(pairs))  # ä¸¦æŸ¥é›†åˆå§‹åŒ–`

- `index`ï¼šç”¨ä¾†å­˜å„²**å–®è©åˆ°ç´¢å¼•çš„æ˜ å°„**ï¼ˆå› ç‚º `DSU` åªè™•ç†æ•¸å­—ï¼‰ã€‚
- `count`ï¼šç”¨ä¾†åˆ†é…å”¯ä¸€çš„ç´¢å¼•çµ¦æ¯å€‹å–®è©ã€‚
- `dsu`ï¼šä¸¦æŸ¥é›†æ•¸æ“šçµæ§‹ã€‚

---

### **Step 3: å°‡ `pairs` ä¸­çš„å–®è©åŠ å…¥ `index`ï¼Œä¸¦ç”¨ä¸¦æŸ¥é›†åˆä½µå®ƒå€‘**

`for pair in pairs:     for p in pair:         if p not in index:             index[p] = next(count)  # åˆ†é…å”¯ä¸€çš„æ•¸å­—ç´¢å¼•     dsu.union(index[pair[0]], index[pair[1]])  # åˆä½µç›¸ä¼¼çš„å–®è©`

- **å°‡ `pairs[i] = [a, b]` è½‰æ›ç‚º `index[a]` å’Œ `index[b]`**ã€‚
- **åˆä½µ `a` å’Œ `b`ï¼Œä½¿å®ƒå€‘å±¬æ–¼åŒä¸€çµ„**ã€‚
- **ä¸¦æŸ¥é›†ä¿è­‰ç›¸ä¼¼å–®è©æœƒå½¢æˆé€£é€šåˆ†é‡**ã€‚

---

### **Step 4: éæ­· `words1` å’Œ `words2`ï¼Œåˆ¤æ–·å®ƒå€‘æ˜¯å¦å±¬æ–¼ç›¸åŒçš„é›†åˆ**

`return all(w1 == w2 or            w1 in index and w2 in index and            dsu.find(index[w1]) == dsu.find(index[w2])            for w1, w2 in zip(words1, words2))`

- `w1 == w2`ï¼šå¦‚æœ `w1` å’Œ `w2` æœ¬ä¾†å°±ç›¸åŒï¼Œé‚£éº¼å®ƒå€‘é¡¯ç„¶æ˜¯ç›¸ä¼¼çš„ã€‚
- `w1 in index and w2 in index`ï¼šç¢ºä¿ `w1` å’Œ `w2` **éƒ½åœ¨ `pairs` ä¸­**ï¼Œå¦å‰‡å®ƒå€‘æ²’æœ‰ç›¸ä¼¼é—œä¿‚ã€‚
- `dsu.find(index[w1]) == dsu.find(index[w2])`ï¼š
    - **å¦‚æœ `w1` å’Œ `w2` å±¬æ–¼åŒä¸€å€‹é€£é€šåˆ†é‡ï¼Œé‚£éº¼å®ƒå€‘æ˜¯ç›¸ä¼¼çš„**ã€‚
    - **å¦å‰‡è¿”å› `False`**ã€‚

---

## **èˆ‰ä¾‹è§£æ**

### **Example 1**

`words1 = ["great", "acting", "skills"] words2 = ["fine", "drama", "talent"] pairs = [["great", "good"], ["good", "fine"], ["acting", "drama"], ["skills", "talent"]]`

### **Step 1: åˆå§‹åŒ–**

- **é•·åº¦ç›¸åŒ**ï¼Œç¹¼çºŒåŸ·è¡Œã€‚

---

### **Step 2: å»ºç«‹ `index` æ˜ å°„**

`index = {     "great": 0, "good": 1, "fine": 2,     "acting": 3, "drama": 4, "skills": 5, "talent": 6 }`

---

### **Step 3: ä¸¦æŸ¥é›†åˆä½µ**

åˆä½µ `pairs`ï¼š

`great - good - fine acting - drama skills - talent`

å°æ‡‰çš„ä¸¦æŸ¥é›† `par[]`ï¼š

`[1, 1, 1, 4, 4, 6, 6]`

---

### **Step 4: åˆ¤æ–·å¥å­æ˜¯å¦ç›¸ä¼¼**

`find("great") == find("fine") â†’ True find("acting") == find("drama") â†’ True find("skills") == find("talent") â†’ True`

**çµæœï¼š`True`**

---

## **æ™‚é–“è¤‡é›œåº¦åˆ†æ**

|æ­¥é©Ÿ|è¤‡é›œåº¦|
|---|---|
|**Step 1: é•·åº¦æª¢æŸ¥**|`O(1)`|
|**Step 2: å»ºç«‹ `index`ï¼ˆå–®è©æ˜ å°„åˆ°ç´¢å¼•ï¼‰**|`O(P)`ï¼ˆ`P` ç‚º `pairs` æ•¸é‡ï¼‰|
|**Step 3: ä¸¦æŸ¥é›†åˆä½µ `pairs`**|`O(P Î±(P)) â‰ˆ O(P)`|
|**Step 4: åˆ¤æ–· `words1[i]` å’Œ `words2[i]` æ˜¯å¦ç›¸ä¼¼**|`O(W Î±(W)) â‰ˆ O(W)`ï¼ˆ`W` ç‚º `words1` é•·åº¦ï¼‰|
|**ç¸½è¨ˆ**|`O(P + W)`|

ç”±æ–¼ `Î±(n) â‰ˆ O(1)`ï¼Œæ‰€ä»¥é€™æ˜¯ä¸€å€‹æ¥è¿‘ç·šæ€§çš„è§£æ³•ã€‚

---

## **å…¶ä»–è§£æ³•ï¼ˆä¸éœ€ä»£ç¢¼ï¼‰**

### **1. DFS æˆ– BFS**

- **æ§‹å»ºåœ–**ï¼Œ`pairs[i] = [a, b]` ä»£è¡¨ä¸€æ¢**ç„¡å‘é‚Š**ã€‚
- **å° `words1[i]` å’Œ `words2[i]` é€²è¡Œ BFS æˆ– DFS æœç´¢ï¼Œæª¢æŸ¥æ˜¯å¦å¯é”**ã€‚
- **æ™‚é–“è¤‡é›œåº¦ `O(W * P)`**ï¼Œæ¯”ä¸¦æŸ¥é›†ç¨æ…¢ã€‚

### **2. Floyd-Warshallï¼ˆå‹•æ…‹è¦åŠƒï¼‰**

- **ä½¿ç”¨é„°æ¥çŸ©é™£å­˜å„²å–®è©ä¹‹é–“çš„ç›¸ä¼¼åº¦**ã€‚
- **ä½¿ç”¨ Floyd-Warshall æ±‚ä»»æ„å…©å€‹å–®è©çš„æœ€çŸ­è·¯å¾‘ï¼ˆå¯é”æ€§ï¼‰**ã€‚
- **æ™‚é–“è¤‡é›œåº¦ `O(N^3)`ï¼ˆå¤ªæ…¢ï¼Œä¸é©åˆå¤§æ•¸æ“šï¼‰**ã€‚

---

## **ç¸½çµ**

### **æœ€ä½³è§£æ³•ï¼šä¸¦æŸ¥é›†ï¼ˆUnion-Findï¼‰**

- **æ™‚é–“ `O(P + W)`ï¼Œç©ºé–“ `O(P)`**
- **åˆ©ç”¨ä¸¦æŸ¥é›†å¿«é€Ÿåˆä½µèˆ‡æŸ¥æ‰¾**
- **é©ç”¨æ–¼å¤§æ•¸æ“šé‡çš„æŸ¥è©¢**

### **å…¶ä»–è§£æ³•**

1. **DFS / BFS**ï¼ˆ`O(W * P)`ï¼‰ï¼šé©ç”¨æ–¼å°è¦æ¨¡æ•¸æ“šã€‚
2. **Floyd-Warshall**ï¼ˆ`O(N^3)`ï¼‰ï¼šé©ç”¨æ–¼æ¥µå°æ•¸æ“šï¼Œä½†ä¸é©åˆå¤§è¦æ¨¡åœ–ã€‚

### **ç‚ºä½•é¸æ“‡ä¸¦æŸ¥é›†ï¼Ÿ**

- **æŸ¥æ‰¾æ˜¯å¦é€£é€šæœ€å¿«ï¼Œå¹¾ä¹ `O(1)`**
- **æ¯” DFS/BFS æ›´é©åˆå¤§æ•¸æ“š**
- **æ¯” Floyd-Warshall ç¯€çœç©ºé–“**
- **é©åˆå‹•æ…‹è™•ç†å–®è©é—œä¿‚çš„å ´æ™¯**

é€™å°±æ˜¯ç‚ºä»€éº¼ **ä¸¦æŸ¥é›†** æ˜¯è§£æ±ºé€™é¡ **é€£é€šæ€§æŸ¥è©¢å•é¡Œ** çš„**æœ€ä½³é¸æ“‡**ï¼ ğŸš€

  

O

æœå°‹
