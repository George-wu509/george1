Lintcode 139
ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œæ‰¾åˆ°ä¸€ä¸ªå’Œæœ€æ¥è¿‘äºé›¶çš„å­æ•°ç»„ã€‚è¿”å›æ»¡è¶³è¦æ±‚çš„å­æ•°ç»„çš„èµ·å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚ä½ åªéœ€è¦è€ƒè™‘**å…¶ä¸­çš„ä¸€ç§å¯èƒ½æ€§**å³å¯ï¼Œå…·ä½“å¯ä»¥å‚è€ƒæ ·ä¾‹ã€‚

**æ ·ä¾‹1**
```python
è¾“å…¥: 
[-3,1,1,-3,5] 
è¾“å‡º: 
[0,2]
è§£é‡Š: è¿”å› [0,2], [1,3], [1,1], [2,2], [0,4] ä¸­çš„ä»»æ„ä¸€ä¸ªå‡å¯ã€‚
```
**æ ·ä¾‹2**
```python
è¾“å…¥: 
[2147483647]
è¾“å‡º: 
[0,0]
```

```python
    def subarray_sum_closest(self, nums):
        prefix_sum = [(0, -1)]
        for i, num in enumerate(nums):
            prefix_sum.append((prefix_sum[-1][0] + num, i))
            
        prefix_sum.sort()
        
        closest, answer = sys.maxsize, []
        for i in range(1, len(prefix_sum)):
            if closest > prefix_sum[i][0] - prefix_sum[i - 1][0]:
                closest = prefix_sum[i][0] - prefix_sum[i - 1][0]
                left = min(prefix_sum[i - 1][1], prefix_sum[i][1]) + 1
                right = max(prefix_sum[i - 1][1], prefix_sum[i][1])
                answer = [left, right]
        
        return answer
```
pass

nums = Â [-3, 1, 1, -3, 5]
è§£é‡‹:
step1. å¾id=0éæ­·åˆ°å°¾ç„¶å¾Œå°‡å‰ç¼€å’Œè·Ÿidéƒ½å­˜èµ·ä¾†
prefix_sum = [(0,-1),(-3,0),(-2,1),(-1,2),(-4,3),(1,4)]
step2. æ’åºprefix_sum
prefix_sum = [(-4,3),(-3,0),(-2,1),(-1,2),(0,-1),(1,4)]
step3. å¾id=0éæ­·åˆ°å°¾è¨ˆç®—æ’åºéçš„prefix_sum, æ¯”ç›¸é„°çš„prefix_sum. è­¬å¦‚:
 prefix_sum[3]- prefix_sum[0] ç­‰åŒæ–¼å¾id1,2,3çš„å’Œ  1+1+-3=-1 


# **LintCode 139: Subarray Sum Closestï¼ˆæœ€æ¥è¿‘é›¶çš„å­æ•°ç»„å’Œï¼‰**

---

## **é¢˜ç›®æè¿°**

ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums`ï¼Œæ‰¾åˆ°**å’Œæœ€æ¥è¿‘ 0** çš„å­æ•°ç»„ï¼Œè¿”å›å…¶**èµ·å§‹ç´¢å¼•å’Œç»“æŸç´¢å¼•**ã€‚

#### **ç¤ºä¾‹**

`è¾“å…¥ï¼š nums = [-3, 1, 1, -3, 5]  è¾“å‡ºï¼š (1, 3)`

**è§£é‡Š**

`å­æ•°ç»„ [1,1,-3] çš„å’Œä¸º -1ï¼Œæ˜¯æœ€æ¥è¿‘ 0 çš„å­æ•°ç»„ã€‚`

---

## **è§£æ³•ï¼šå‰ç¼€å’Œ + æ’åºï¼ˆåŒæŒ‡é’ˆï¼‰**

### **æ ¸å¿ƒæ€è·¯**

1. **å‰ç¼€å’Œ**
    
    - è®¡ç®— `prefix_sum[i]`ï¼Œè¡¨ç¤º `nums[0]` åˆ° `nums[i]` çš„ç´¯ç§¯å’Œï¼š 
    - **å¦‚æœæŸä¸¤ä¸ª `prefix_sum` éå¸¸æ¥è¿‘**ï¼Œè¯´æ˜**å®ƒä»¬ä¹‹é—´çš„å­æ•°ç»„å’Œæ¥è¿‘ `0`**ï¼š 
2. **æ’åº + åŒæŒ‡é’ˆ**
    
    - å°†æ‰€æœ‰ `(prefix_sum, index)` æ’åºã€‚
    - **ç›¸é‚»çš„ `prefix_sum[i]` ä¹‹å·®è¶Šå°ï¼Œè¡¨ç¤º `nums[l:r]` çš„å’Œè¶Šæ¥è¿‘ 0**ã€‚
    - éå†æ’åºåçš„ `prefix_sum`ï¼Œæ‰¾åˆ°**æœ€å°çš„å·®å€¼**ï¼Œè¿”å›ç´¢å¼•ã€‚

---

### **ä»£ç è§£æ**
```python
import sys

def subarray_sum_closest(self, nums):
    prefix_sum = [(0, -1)]  # è®°å½• (å‰ç¼€å’Œ, ç´¢å¼•)ï¼Œåˆå§‹åŒ–å‰ç¼€å’Œ0å‡ºç°äº-1ä½ç½®

    # è®¡ç®—å‰ç¼€å’Œ
    for i, num in enumerate(nums):
        prefix_sum.append((prefix_sum[-1][0] + num, i))

    # æŒ‰å‰ç¼€å’Œæ’åº
    prefix_sum.sort()

    closest, answer = sys.maxsize, []

    # æ‰¾æœ€å°çš„å‰ç¼€å’Œå·®å€¼
    for i in range(1, len(prefix_sum)):
        diff = prefix_sum[i][0] - prefix_sum[i - 1][0]
        if diff < closest:
            closest = diff
            left = min(prefix_sum[i - 1][1], prefix_sum[i][1]) + 1
            right = max(prefix_sum[i - 1][1], prefix_sum[i][1])
            answer = [left, right]

    return answer

```

---

## **é€æ­¥æ‰§è¡Œåˆ†æ**

**è¾“å…¥**

`nums = [-3, 1, 1, -3, 5]`

---

### **æ­¥éª¤ 1ï¼šè®¡ç®—å‰ç¼€å’Œ**

|`i`|`num`|`prefix_sum[i]` è®¡ç®—|`prefix_sum` ç»“æœ|
|---|---|---|---|
|-1|0|`0`|`[(0, -1)]`|
|0|-3|`0 + (-3) = -3`|`[(-3, 0)]`|
|1|1|`-3 + 1 = -2`|`[(-2, 1)]`|
|2|1|`-2 + 1 = -1`|`[(-1, 2)]`|
|3|-3|`-1 + (-3) = -4`|`[(-4, 3)]`|
|4|5|`-4 + 5 = 1`|`[(1, 4)]`|

æœ€ç»ˆï¼š

`prefix_sum = [(0, -1), (-3, 0), (-2, 1), (-1, 2), (-4, 3), (1, 4)]`

---

### **æ­¥éª¤ 2ï¼šæ’åº `prefix_sum`**

æ’åºåï¼š

`prefix_sum = [(-4, 3), (-3, 0), (-2, 1), (-1, 2), (0, -1), (1, 4)]`

---

### **æ­¥éª¤ 3ï¼šéå†ç›¸é‚»å·®å€¼**

|`i`|`prefix_sum[i-1]`|`prefix_sum[i]`|`diff` è®¡ç®—|`closest` æ›´æ–°|`answer`|
|---|---|---|---|---|---|
|1|`(-4,3)`|`(-3,0)`|`|-3 - (-4)|= 1`|
|2|`(-3,0)`|`(-2,1)`|`|-2 - (-3)|= 1`|
|3|`(-2,1)`|`(-1,2)`|`|-1 - (-2)|= 1`|
|4|`(-1,2)`|`(0,-1)`|`|0 - (-1)|= 1`|
|5|`(0,-1)`|`(1,4)`|`|1 - 0|= 1`|

æœ€ç»ˆè¿”å›ï¼š

`[1, 3]`

---

## **æ—¶é—´ä¸ç©ºé—´å¤æ‚åº¦åˆ†æ**

3. **æ—¶é—´å¤æ‚åº¦**
    
    - **è®¡ç®—å‰ç¼€å’Œ `O(n)`**
    - **æ’åº `O(n log n)`**
    - **éå† `O(n)`**
    - **æ€»å¤æ‚åº¦ `O(n log n)`**
4. **ç©ºé—´å¤æ‚åº¦**
    
    - **`O(n)`**ï¼ˆå­˜å‚¨ `prefix_sum`ï¼‰

---

## **å…¶ä»–è§£æ³•**

### **1. æš´åŠ›æ³• `O(n^2)`**

- **æ€è·¯**
    - æšä¸¾æ‰€æœ‰å­æ•°ç»„ `nums[i:j]`ï¼Œè®¡ç®— `sum(nums[i:j])` å¹¶æ‰¾æœ€æ¥è¿‘ `0` çš„ã€‚
    - **ç¼ºç‚¹**ï¼šæ—¶é—´å¤æ‚åº¦è¿‡é«˜ã€‚
```python
def subarray_sum_closest(nums):
    n = len(nums)
    closest = float('inf')
    answer = []

    for i in range(n):
        curr_sum = 0
        for j in range(i, n):
            curr_sum += nums[j]
            if abs(curr_sum) < closest:
                closest = abs(curr_sum)
                answer = [i, j]

    return answer

```
- **æ—¶é—´å¤æ‚åº¦ `O(n^2)`**
- **é€‚ç”¨äºæ•°æ®è¾ƒå°**

---

## **æ–¹æ³•æ¯”è¾ƒ**

|æ–¹æ³•|æ—¶é—´å¤æ‚åº¦|ç©ºé—´å¤æ‚åº¦|é€‚ç”¨æƒ…å†µ|
|---|---|---|---|
|**å‰ç¼€å’Œ + æ’åºï¼ˆæœ€ä½³è§£æ³•ï¼‰**|`O(n log n)`|`O(n)`|**å¤§æ•°æ®æœ€ä¼˜**|
|æš´åŠ›æ³•|`O(n^2)`|`O(1)`|**æ•°æ®è¾ƒå°æ—¶å¯ç”¨**|

ğŸš€ **å‰ç¼€å’Œ + æ’åº `O(n log n)` æ˜¯æœ€ä¼˜è§£ï¼Œé€‚ç”¨äºå¤§è§„æ¨¡æ•°æ®ï¼**