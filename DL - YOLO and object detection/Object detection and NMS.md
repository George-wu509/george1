
NMS: <mark style="background: #FFF3A3A6;">RCNN series, YOLO series, SSD</mark>
No NMS: <mark style="background: #BBFABBA6;">No Anchor(CenterNet..), YOLOv10, DETR</mark>

NMS: 將所有的框(boundary box)依照confidence排序, 先選出最高confidence框, 然後計算這個框跟其他框的IoU, 如果高於門檻則刪除. 接下來再繼續下一個第二高confidence框 

**AI 物件偵測模型是否有的 AI 模型得到結果之後還需要用 NMS？**

是的，許多主流的 AI 物件偵測模型在得到初步的預測結果後，通常**需要**使用非極大值抑制（NMS）來進行後處理。這是因為模型可能會對同一個物體產生多個重疊的預測框。NMS 的作用就是從這些重疊的預測框中選擇出最優的一個，並抑制掉其餘的冗餘框。

然而，近年來也出現了一些**不需要** NMS 的物件偵測模型。這些模型通常採用不同的預測和匹配機制，例如直接預測物體的中心點和尺寸，並使用一對一的匹配策略，從而在模型架構上避免了產生大量重疊框的可能性，因此在後處理階段也就不需要 NMS。

**有哪些常用 AI based object detection model 需要 NMS, 那些不需要?**

**需要 NMS 的常用模型：**

- **基於錨框（Anchor-based）的模型：**
    - **R-CNN 系列 (R-CNN, Fast R-CNN, Faster R-CNN)：** 這些是經典的兩階段偵測器，會先生成候選區域，然後對這些區域進行分類和邊界框回歸。由於錨框的設計，可能對同一個物體產生多個候選框，因此需要 NMS 來篩選。
    - **YOLO 系列 (YOLOv1, YOLOv2, YOLOv3, YOLOv4, YOLOv5, YOLOv7, YOLOv8 等)：** YOLO 是一種單階段偵測器，它將圖像劃分為網格，並在每個網格單元中預測多個帶有不同尺寸和比例的錨框。因此，對於同一個物體，可能會有多個錨框被預測為包含該物體，需要 NMS 來去除冗餘框。
    - **SSD (Single Shot MultiBox Detector)：** 類似於 YOLO，SSD 也是一種單階段偵測器，它在不同尺度的特徵圖上使用一系列預定義的錨框進行預測，因此也需要 NMS。
    - **RetinaNet：** 這是一種單階段偵測器，旨在解決單階段偵測器在訓練過程中前景-背景類別不平衡的問題。它依然基於錨框進行預測，因此需要 NMS。

**不需要 NMS 的常用模型（或正在發展此方向的模型）：**

- **基於中心點（Center-based）的模型：**
    
    - **CenterNet：** 這個模型將每個物體視為一個點——其邊界框的中心點。模型預測每個物體的中心點heatmap，以及到其邊界框邊緣的偏移量。由於每個物體只預測一個中心點，因此在後處理中不需要 NMS 來去除重複框。它通常通過提取 heatmap 的局部峰值來確定物體中心。
    - **Objects as Points (ExtremeNet 的基礎)：** 這個方法也預測物體的中心點和其他關鍵點，並將它們組合起來形成邊界框，避免了使用錨框和 NMS。
    - **YOLOv10：** 最新的 YOLO 版本 YOLOv10 正在探索和採用無 NMS 的訓練方法，旨在提高推理速度。
- **基於 Transformer 的模型：**
    
    - **DETR (DEtection TRansformer)：** DETR 是一種開創性的使用 Transformer 進行物件偵測的模型。它直接預測一組固定數量的物體邊界框，並使用二分匹配（Bipartite Matching）將預測結果與真實標註進行匹配。由於其預測是直接且唯一的，因此在推理階段不需要 NMS。
    - **Deformable DETR 及其後續版本 (如 DINO)：** 這些模型在 DETR 的基礎上進行了改進，但仍然保留了基於 Transformer 的架構和二分匹配的特性，因此也不需要 NMS。

**請繁體中文解釋甚麼是 NMS（Non-Maximum Suppression）**

**非極大值抑制（Non-Maximum Suppression，簡稱 NMS）** 是一種在物件偵測任務中常用的**後處理技術**。<mark style="background: #FFF3A3A6;">當一個訓練好的物件偵測模型對一張圖片進行預測時，可能會對同一個物體產生多個邊界框（bounding box）。這些邊界框可能彼此重疊</mark>，並且都帶有一個**置信度分數**（confidence score），表示模型認為這個框內包含特定物體的可能性有多大。

NMS 的目標是**從這些重疊的預測框中選擇出最優的一個**，並**抑制（去除）掉其餘的冗餘框**，從而確保每個真實的物體只被一個最準確的邊界框標註出來。

NMS 的典型運作步驟如下：

1. **根據置信度分數對所有的預測框進行排序**，將置信度最高的框放在最前面。
2. **選擇置信度最高的預測框**，並將其加入到最終的偵測結果列表中。
3. **計算這個被選中的預測框與其餘所有預測框之間的重疊程度**（通常使用**交並比，Intersection over Union，IoU** 來衡量）。IoU 的值越高，表示兩個框的重疊程度越大。
4. **對於所有與當前選中框的 IoU 值大於某個預先設定的閾值（例如 0.5）的預測框，將它們從待處理的預測框列表中移除**。這是因為這些框很可能都是檢測到同一個物體，而我們已經選擇了置信度最高的那個。
5. **重複步驟 2-4**，直到待處理的預測框列表為空。
6. **最終偵測結果列表中的框就是經過 NMS 處理後得到的、每個物體一個的最佳預測框。**

**總結來說，NMS 的作用是去除物件偵測模型產生的冗餘和重疊的預測框，保留最可信的預測結果，從而提高偵測結果的準確性和可讀性。**